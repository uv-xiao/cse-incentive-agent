# USAGE.md - ZZW考公学习日记使用指南

## 🎯 项目简介

ZZW考公学习日记是一个专为考公学习设计的激励系统，通过每日问卷、积分奖励和AI生成的鼓励报告，帮助你保持学习动力，追踪学习进度。

**最新优化**：
- ✅ AI报告升级：详细分析积分获得情况，解释每项积分背后的意义
- ✅ 日期处理修复：07-07问卷在任何时候提交都会正确记录为07-07日期
- 🆕 **问卷智能优化**：基于用户反馈自动优化问卷选项（2025-07-08）

## 📋 日常使用流程

### 📱 新工作流程（支持ZZW不会Python）

1. **操作员导出问卷**
   - 运行程序：`pixi run python main.py`
   - 选择 "1. 📤 导出今日问卷 (Excel)"
   - 系统生成Excel文件：`questionnaires/daily_questionnaire_YYYY-MM-DD.xlsx`
   - 将Excel文件发送给ZZW

2. **ZZW填写问卷**
   - 打开Excel文件
   - 在"答案"列填写相应内容
   - 选择题：可以填写选项编号（0,1,2等）或自然语言
   - 文本题：直接填写文字
   - 保存文件并发回
   
   💡 **智能答案识别**：系统现在支持自然语言答案！
   - **直接写选项编号**：如果知道选项，直接写数字最准确（如"2"）
   - **数字开头优先**：答案开头的数字会被优先识别（如"2 有时候会焦虑"→选项2）
   - **自然语言理解**：
     - "学了10个小时" → 自动识别为600分钟并匹配对应选项
     - "做了50道题" → 自动匹配31-50题或50-80题的选项
     - "写了5000字以上" → 正确匹配"5000+"选项
   - **理由识别**：如果解释了原因（如"网课已经看完了"），系统会记录反馈
   - **智能纠错**：即使写了"没有"但包含数字，系统会优先匹配数字对应的选项

3. **操作员导入答案**
   - 将填好的Excel文件放入`questionnaires/`目录
   - 选择 "2. 📥 导入问卷答案 (Excel)"
   - 系统自动处理并生成报告
   - 查看积分和报告结果
   - **新功能**：如果系统检测到用户反馈，会询问是否根据反馈优化问卷

4. **积分兑换**
   - 选择 "3. 🎁 查看积分商城" 浏览奖励
   - 选择 "4. 🛒 兑换奖励" 进行兑换

### 传统工作流程（会Python的用户）

1. **直接填写问卷**
   - 在主程序中直接回答问题
   - 立即查看报告和积分

### 主菜单功能说明

```
📋 主菜单:
💰 当前积分: XXX分
----------------------------------------
1. 📤 导出今日问卷 (Excel)  - 生成Excel问卷文件
2. 📥 导入问卷答案 (Excel)  - 导入填好的Excel文件
3. 🎁 查看积分商城         - 浏览可兑换的奖励
4. 🛒 兑换奖励            - 使用积分兑换奖励
5. 📄 查看今日报告         - 查看已生成的今日总结
6. 📊 查看积分历史         - 显示最近10天的积分记录
7. 📈 查看学习统计         - 查看总体学习数据
8. 📅 生成周总结          - 生成本周学习总结报告
9. 📉 可视化进度          - 生成积分趋势图表
10. 💾 导出数据           - 导出数据备份
0. 退出系统
```

## 🎮 积分系统说明

### 积分兑换系统

系统专注于大额奖励，鼓励长期坚持和积累：

#### 大额奖励（300-2000分）
- 💻 在线课程 - 300分
- 🍽️ 朋友聚餐 - 400分
- 💆 按摩放松 - 600分
- 🛍️ 购物奖励 - 800分
- 🏖️ 周末短途游 - 1000分
- 📱 换新手机 - 2000分（参考red_black_list.jpg）

### 积分奖励
- 每日签到：+2分
- 学习时长：30分钟(+2)、60分钟(+4)、120分钟(+6)、180分钟(+8)、240分钟(+10)、360分钟(+12)、480分钟(+15)
- 做题数量：10题(+2)、30题(+4)、50题(+6)、80题(+8)、120题(+10)、180题(+12)
- 论文写作：500字(+2)、1000字(+4)、2000字(+6)、3000字(+8)、5000字(+10)
- 背诵知识点：15分钟(+1)、30分钟(+2)、60分钟(+4)、90分钟(+5)、120分钟(+6)
- 网课学习：30分钟(+2)、60分钟(+3)、90分钟(+4)、120分钟(+5)、180分钟(+6)
- 健康习惯：良好睡眠(+1~2)、健康饮食(+1~2)、合理休息(+1~2)
- 学习质量：完成复习(+2~4)、做笔记(+2~3)
- 连续学习：7天全勤(+10)、30天全勤(+50)

### 积分惩罚（加强版）
- 未学习：-6分（原-2分，提升3倍）
- 未签到：-3分（原-1分，提升3倍）
- 不健康习惯：
  - 睡眠不足（<6小时）：-5分（原-2分，提升2.5倍）
  - 饮食不当：-3分（原-1分，提升3倍）
  - 连续学习未休息：-5分（原-2分，提升2.5倍）
- 焦虑情绪：-3分（原-1分，提升3倍）
- 未进行论文写作：-4分（新增）
- 未进行背诵：-3分（新增）
- 未学习网课：-3分（新增）

**惩罚说明**：惩罚分数已大幅提升，旨在建立更强的约束机制，鼓励全面均衡的学习习惯。每日若不注意，可能会产生-20分以上的惩罚，需要特别注意避免。

### 等级系统
- 🌱 初学者（0分）
- 📚 勤奋者（100分）
- 💪 坚持者（300分）
- ⭐ 优秀者（600分）
- 🎓 学霸（1000分）
- 👑 考神（2000分）

## 💡 使用技巧

### 1. 养成每日打卡习惯
- 建议固定时间填写问卷（如每晚9点）
- 设置手机提醒，避免忘记

### 2. 诚实记录
- 如实填写学习情况，系统会根据实际情况给出建议
- 即使今天学习不理想，也要坚持记录

### 3. 关注报告建议
- 仔细阅读AI生成的每日报告
- 根据建议调整学习计划
- **新增功能**：报告现在会详细分析每项积分的获得原因
- 报告会对比积分规则，明确指出你的提升空间
- 扣分项会有具体的改进建议

### 4. 利用数据分析
- 定期查看积分趋势图，了解自己的学习状态
- 通过周总结发现学习规律

### 5. 多维度学习记录
- 记录学习时长：支持超长学习时间（最高8小时以上）
- 记录做题数量：支持大量练习题记录（最高180题以上）
- 记录论文进度：每日论文字数记录，最高支持5000字以上
- 记录背诵时长：法律条文、常识、申论素材等背诵时间
- 记录网课学习：各类培训机构网课学习时间

### 6. 避免惩罚策略
**重要提醒：惩罚分数已大幅提升！**
- 每日至少完成最基础的学习任务（30分钟学习+10道题）避免-6分惩罚
- 保持规律作息，确保6小时以上睡眠避免-5分惩罚
- 即使时间紧张，也要完成一些论文写作、背诵或网课学习，避免额外-3到-4分惩罚
- 注意劳逸结合，避免连续学习不休息的-5分惩罚
- 保持积极心态，管理好情绪避免-3分惩罚
- **最坏情况下，一天可能被扣除超过25分，需要多天努力才能弥补**

## 🤝 与Claude Code协作

### 日常协作模式

1. **查看今日报告**
   ```
   请帮我分析今天的学习报告，看看有什么需要改进的地方
   ```

2. **分析学习趋势**
   ```
   查看最近7天的学习数据，帮我分析学习效率趋势
   ```

3. **制定学习计划**
   ```
   根据我最近的学习记录，帮我制定明天的学习计划
   ```

4. **解决学习问题**
   ```
   最近积分下降，请帮我分析原因并给出改进建议
   ```

### 高级功能定制

1. **添加特殊成就**
   ```
   今天我完成了一套模拟卷，得了85分，请帮我添加特殊成就积分
   ```

2. **调整积分规则**
   ```
   我想增加"早起学习"的积分奖励，请帮我修改积分系统
   ```

3. **生成专题报告**
   ```
   请生成一份关于我做题情况的专项分析报告
   ```

4. **管理兑换奖励**
   ```
   我想添加新的兑换奖励：周末看演唱会，500积分
   ```

5. **批量处理问卷**
   ```
   我有一周的问卷需要补录，请帮我批量处理
   ```

## 🆕 新增功能说明

### 问卷智能优化（2025-07-08）
- 🔧 **笔记问题优化**：新增"📚 使用已有资料学习"选项
  - 用户反馈：之前有整理好的资料，主要是用之前的资料来背
  - 解决方案：为使用现有资料的情况提供合适选项，获得+1分奖励
  - 优化积分规则：使用已有资料学习也能获得积分认可

- 💻 **网课问题优化**：新增"✅ 已完成所有网课"和"🔄 复习已看过的内容"选项
  - 用户反馈：网课已经看完了一遍了，近期不需要再看啦
  - 解决方案：为已完成网课和复习已学内容的情况提供选项
  - 积分奖励：已完成所有网课(+2分)，复习已看过内容(+1分)
  - 避免了对已完成网课用户的不必要惩罚

- 🤖 **用户反馈处理机制**：
  - 自动检测用户在答案中提供的额外说明和建议
  - 收集反馈并提供问卷优化建议
  - 支持基于用户实际使用情况的持续改进

### 智能答案处理（2025-01-06）
- 支持自然语言答案输入，无需严格填写选项编号
- 使用gemini-cli进行智能语义匹配
- 自动识别数字、时间等关键信息
- 回退机制确保答案总能被处理
- 填写时更加灵活自由，减少填写错误

### 做题正确率跟踪（2025-01-06）
- 新增做题正确率填空题，输入0-100的数字
- 根据正确率给予奖励或惩罚：
  - 95%以上：+8分（卓越表现）
  - 90-94%：+6分（优秀表现）
  - 85-89%：+5分（良好表现）
  - 80-84%：+4分（不错表现）
  - 75-79%：+3分（及格表现）
  - 70-74%：+2分（一般表现）
  - 60-69%：+1分（需要努力）
  - 50-59%：0分（警告水平）
  - 40-49%：-2分（较差表现）
  - 30-39%：-3分（很差表现）
  - 30%以下：-5分（严重问题）
- 支持多种输入格式：85、85%、85.5等
- 只有在做了题的情况下才计算正确率积分

### 论文写作追踪
- 系统新增了毕业论文写作进度追踪功能
- 每日可记录完成的论文字数（1-5000字以上）
- 根据写作字数获得相应积分奖励
- 帮助平衡考公学习和论文写作的时间安排

### 背诵学习追踪
- 记录每日背诵时长（法律条文、常识、申论素材等）
- 背诵时间从15分钟到120分钟以上分档计分
- 鼓励系统化的知识点记忆和巩固

### 网课学习追踪
- 支持记录各大培训机构（中公、粉笔、华图等）的网课学习时间
- 学习时长从30分钟到180分钟以上分档
- 帮助合理安排线上学习时间

### 扩展的学习时长和做题数量
- 学习时长选项扩展至480分钟以上（8小时+）
- 练习题数量选项扩展至180题以上
- 更好地适应高强度学习需求

## 📊 数据管理

### 数据存储位置
- 问卷回答：`data/responses.json`
- 积分记录：`data/points.json`
- 兑换奖励：`data/rewards.json`
- 兑换历史：`data/redemption_history.json`
- Excel问卷：`questionnaires/`目录
- 已答问卷：`questionnaires/answered/`目录
- 每日报告：`reports/daily_report_YYYY-MM-DD.md`
- 进度图表：`data/points_trend_YYYYMMDD.png`

### 数据备份
1. 定期使用 "7. 导出数据" 功能
2. 选择JSON格式导出完整数据
3. 保存到云盘或其他安全位置

### 数据恢复
如需恢复数据，将备份的JSON文件内容复制到相应的数据文件中。

## 🔧 常见问题

### Q: gemini-cli无法使用怎么办？
A: 系统有备用模板，会自动生成基础报告。建议尽快安装gemini-cli以获得更好的体验。

### Q: 忘记填写问卷怎么办？
A: 可以补填，但建议养成每日记录的习惯。

### Q: 如何修改已填写的问卷？
A: 当天的问卷可以重新填写，系统会覆盖之前的记录。

### Q: 积分计算有误怎么办？
A: 请检查`data/points.json`文件，必要时可请Claude Code协助修正。

### Q: Excel文件如何填写？
A: 选择题可以填写选项编号（0,1,2等）或自然语言答案，文本题直接填写文字。系统会智能识别自然语言答案。例如：
   - "0 (不要扣分哦！）" → 自动识别为第一个选项
   - "学了2小时" → 自动匹配120分钟选项
   - "做了25道题" → 自动匹配11-30题选项

### Q: 如何添加自定义奖励？
A: 告诉Claude Code你想添加的奖励名称、积分和描述，它会帮你更新奖励列表。

### Q: 兑换的奖励如何记录完成？
A: 系统会自动记录兑换历史，你需要自己完成实际的奖励（如休息、购物等）。

## 📈 进阶使用

### 1. 自定义问卷问题
请Claude Code帮助你在`modules/questionnaire.py`中添加个性化问题。

### 2. 调整积分权重
根据个人情况，可请Claude Code调整`modules/scoring.py`中的积分规则。

### 3. 集成其他工具
- 可以将报告发送到邮箱
- 集成番茄钟等学习工具
- 添加学习资料管理功能
- 批量处理历史问卷
- 导出积分兑换凭证

### 4. 兑换奖励管理
- 自定义奖励类别和积分
- 设置限时特惠奖励
- 添加节日特别奖励
- 创建个性化奖励包

## 🎯 最佳实践

1. **坚持记录**：即使学习时间很少，也要坚持打卡
2. **及时反思**：根据报告调整学习策略
3. **设定目标**：每周设定积分目标，激励自己
4. **保持平衡**：注意休息和健康，避免过度疲劳
5. **正向激励**：关注进步而非完美
6. **避免惩罚**：新的惩罚机制较严格，需要注意全面发展

## 🔄 回档功能说明

### 什么是回档？
回档功能允许你删除某一天的所有记录，包括：
- 问卷答案记录
- 积分记录
- 生成的报告文件

### 何时使用回档？
1. **智能识别错误**：当智能答案识别系统识别错误，导致积分计算不正确时
2. **重复记录**：不小心为同一天重复填写了问卷
3. **测试数据**：需要删除测试时产生的数据
4. **数据错误**：填写了错误的信息需要重新来过

### 如何使用回档？
1. 在主菜单选择 "11. 🔄 回档（删除某天记录）"
2. 系统会显示所有可回档的日期和对应的积分
3. 选择要回档的日期（可以输入序号或直接输入日期）
4. 系统会要求二次确认，输入 'YES' 确认删除
5. 回档完成后，系统会显示删除的内容

### 注意事项
- ⚠️ **回档操作不可逆**！删除的数据无法恢复
- 回档会重新计算总积分，确保积分的准确性
- 建议在回档前先导出数据备份（使用菜单选项10）
- 回档后，该日期的所有相关文件都会被删除

### 示例操作
```
🔄 回档功能 - 删除某天的记录
==================================================
⚠️  警告：此操作将永久删除选定日期的所有数据！

📅 可回档的日期：
1. 2025-01-07 (积分: +25)
2. 2025-01-06 (积分: -5)
3. 2025-01-05 (积分: +30)

请输入: 2

⚠️  确定要删除 2025-01-06 的所有记录吗？
输入 'YES' 确认删除: YES

✅ 成功回档 2025-01-06 的数据！删除了问卷记录和 -5 积分。
   - 删除了问卷记录
   - 删除了积分记录: -5分
   - 当前总积分: 55分
   - 删除了报告文件
```

## 🔧 高级功能

### 用户反馈处理
当ZZW在填写问卷时提供了额外的说明或建议（如"网课已经看完了一遍了"），系统会：
1. 自动识别并记录这些反馈
2. 保存到 `questionnaires/user_feedback.json`
3. 在导入答案后询问是否要根据反馈优化问卷
4. 生成修改建议文件供参考

### Gemini-cli警告
如果智能识别过程中遇到问题，系统会显示详细的警告信息：
- ⚠️ Gemini处理超时
- ⚠️ Gemini返回非预期格式
- ⚠️ Gemini处理失败（包含具体错误信息）
- ⚠️ Gemini无法确定答案（使用回退方案）

## 📝 更新日志

### 2025-07-08 - 问卷智能优化和日期处理修复
- **🔧 问卷优化**：
  - 笔记问题新增"📚 使用已有资料学习"选项，获得+1分奖励
  - 网课问题新增"✅ 已完成所有网课"(+2分)和"🔄 复习已看过的内容"(+1分)选项
  - 优化积分计算逻辑，避免对已完成学习阶段用户的误判
  - 基于用户真实反馈进行的针对性改进
- **📅 日期处理修复**：
  - 修复07-07问卷在07-08提交时错误记录为07-08的问题
  - 现在系统会从Excel文件名或内容中提取问卷原始日期
  - 确保问卷记录的是其创建日期而非提交日期
  - 向后兼容，不影响现有功能
- **🤖 问卷优化器改进**：
  - 问卷优化器现在能正确识别需要Claude Code权限的代码修改
  - 优化用户反馈处理流程，提供更准确的修改建议

### 2025-01-07 - 完善用户反馈和错误处理
- **用户反馈处理机制**：
  - 自动检测用户在答案中的修改建议
  - 导入后询问是否根据反馈优化问卷
  - 生成 `modification_suggestions.txt` 文件
  - 为后续Claude自动优化做准备
- **Gemini错误处理增强**：
  - 显示详细的Gemini处理错误信息
  - 超时、格式错误、执行失败都有明确提示
  - 自动使用回退方案确保识别继续进行

### 2025-01-07 - 智能识别系统大幅改进
- **智能识别优化**：
  - 🎯 **优先提取数字**：如果答案开头是数字（如"2 有时候..."），直接采用该数字作为选项
  - 📊 **智能数量匹配**：
    - "10个小时" → 自动转换为600分钟并匹配对应选项
    - "50题" → 匹配包含50题的选项范围
    - "5000字以上" → 匹配"5000+"选项而非"没有"
  - 💭 **理解用户意图**：
    - 识别用户提供的理由（如"网课已经看完了"）
    - 不会错误地将包含数字的答案识别为"没有"
  - 📈 **增强的范围匹配**：支持各种范围表达（X-Y、X～Y、X以上、X+等）
- **用户反馈收集**：
  - 自动识别用户对问题的修改建议
  - 将反馈保存到 `questionnaires/user_feedback.json`
  - 提示是否根据反馈修改问卷
- **识别准确性提升**：
  - 修复了将"10个小时"识别为"没有学习"的问题
  - 修复了将"5000字以上"识别为"没有写论文"的问题
  - 修复了无法识别答案中已有选项编号的问题

### 2025-01-07 - 新增回档功能
- **回档功能**：
  - 支持删除指定日期的所有记录
  - 自动重新计算总积分
  - 删除相关的报告文件
  - 提供二次确认机制防止误操作
  - 显示详细的删除信息
- **数据安全**：
  - 要求输入 'YES' 确认删除
  - 建议回档前先备份数据
  - 显示将要删除的积分信息

### 2025-01-07 - 增强报告生成详细度
- **报告生成优化**：
  - 在提示词中加入完整的积分规则说明
  - 要求AI详细分析每项积分的获得原因
  - 按类别组织积分明细，更清晰直观
  - 增加对积分规则的对比分析，指出提升空间
  - 强化对扣分项的改进建议
- **备用报告模板增强**：
  - 提供更详细的积分分析框架
  - 增加积分提升小贴士
  - 优化视觉呈现和鼓励语言
- **数据展示改进**：
  - 显示实际数值而非仅显示选项
  - 分离主要学习项目和扩展项目
  - 优化积分明细的分类展示

### 2025-01-06 - 智能答案处理 & 做题正确率 & 惩罚系统加强
- **新增智能答案识别功能**：
  - 支持自然语言答案输入
  - 使用gemini-cli进行语义理解
  - 自动匹配最合适的选项
  - 提供智能识别结果反馈
- **新增做题正确率跟踪**：
  - 添加正确率填空题
  - 根据正确率给予-5到+8分的奖惩
  - 鼓励高质量学习，避免盲目刷题
- **惩罚分数提升2-3倍**：
  - 未学习：-2分 → -6分
  - 未签到：-1分 → -3分
  - 睡眠不足：-2分 → -5分
  - 饮食不当：-1分 → -3分
  - 未休息：-2分 → -5分
  - 焦虑情绪：-1分 → -3分
- **新增惩罚项目**：
  - 未进行论文写作：-4分
  - 未进行背诵：-3分
  - 未学习网课：-3分
- **调整激励消息**：适应新的积分体系，增加对负分情况的鼓励

## 💪 激励寄语

考公之路虽然艰辛，但每一天的坚持都是在为梦想添砖加瓦。这个系统会陪伴你走过这段旅程，记录你的努力，见证你的成长。

记住：**不积跬步，无以至千里**。

加油，ZZW！考公必胜！🌟